OCFL OBJECT VALIDATION REPORT
Object ID: obj-032
Validation Date: 2025-11-09
Status: INVALID

================================================================================
VALIDATION ERROR SUMMARY
================================================================================

Error Code: E040
Error Message: "version head not most recent version: v1"
Location: root inventory.json

The root inventory.json file declares v1 as the head version ("head": "v1"), but the
object structure contains versions v1 and v2, making v1 NOT the most recent version.

================================================================================
DETAILED ANALYSIS
================================================================================

1. INVENTORY INCONSISTENCY ISSUE

   Root inventory.json head pointer: v1
   Actual versions in object: v1, v2
   Expected head pointer: v2 (the most recent version)

   This violates the OCFL specification which requires the head pointer in the root
   inventory.json to point to the most recent version of the object.

2. INVENTORY FILE COMPARISON

   Root inventory.json:
   - head: "v1"
   - Contains versions: v1, v2
   - Manifest entries: 1 digest mapping to v1/content/test.txt

   v1/inventory.json:
   - head: "v1"
   - Contains versions: v1 only
   - Status: CORRECT (v1 is the head for this version)

   v2/inventory.json:
   - head: "v2"
   - Contains versions: v1, v2
   - Status: CORRECT (v2 is the head for this version)

3. STRUCTURE ANALYSIS

   Current file structure:
   /workspace/objects/obj-032/
   ├── 0=ocfl_object_1.1
   ├── inventory.json (HEAD POINTER IS WRONG: v1 instead of v2)
   ├── inventory.json.sha512
   ├── v1/
   │   ├── content/test.txt
   │   ├── inventory.json (correct)
   │   └── inventory.json.sha512
   └── v2/
       ├── inventory.json (correct, but root is wrong)
       └── inventory.json.sha512

   Note: v2 directory does not contain a content/ subdirectory, only inventory files.
   This is valid as v2 inherits the content/test.txt reference from v1.

4. VERSION HISTORY

   v1: Created 2021-03-31T08:22:37.241208990-05:00 (message: "Simple example")
   v2: Created 2021-03-31T08:51:24.084110226-05:00 (message: "Simple example v2")

   Both versions reference the same file digest:
   24f950aac7b9ea9b3cb728228a0c82b67c39e96b4b344798870d5daee93e3ae59...

================================================================================
ROOT CAUSE
================================================================================

The root inventory.json file has an incorrect "head" field value. It points to "v1"
when it should point to "v2". This is a critical OCFL specification violation
(error code E040).

The v2/inventory.json file has the correct head pointer ("v2"), indicating that
the object was properly versioned when v2 was created, but the root inventory.json
was not updated accordingly.

================================================================================
RECOMMENDED FIXES
================================================================================

1. PRIMARY FIX (REQUIRED):

   Update the root inventory.json file:
   - Change line 5: "head": "v1" → "head": "v2"
   - Recalculate the SHA512 checksum of the updated inventory.json
   - Update inventory.json.sha512 with the new checksum

   The updated line should be:
   "head": "v2",

2. VERIFICATION STEPS:

   a) Update the root inventory.json:
      - Edit /workspace/objects/obj-032/inventory.json
      - Change "head": "v1" to "head": "v2"

   b) Recalculate and update the checksum:
      Execute: sha512sum /workspace/objects/obj-032/inventory.json > /workspace/objects/obj-032/inventory.json.sha512

   c) Validate the fix:
      Execute: ocfl validate --object /workspace/objects/obj-032
      Expected output: Object validation should pass without errors

3. ALTERNATIVE APPROACH (if v2 version should not exist):

   If v2 was created by mistake and should be removed:
   - Delete /workspace/objects/obj-032/v2/ directory
   - Ensure root inventory.json only contains v1 and has "head": "v1"
   - Update the checksum file accordingly

   However, this approach is only valid if v2 should not exist in the object history.

================================================================================
PREVENTION
================================================================================

- Always ensure the root inventory.json "head" pointer is updated to the most
  recent version number whenever a new version is created
- The root inventory.json should always reflect the latest state of the object
- Version inventory.json files (v1/inventory.json, v2/inventory.json, etc.)
  represent the state at that point in time and should not be modified after creation

================================================================================
