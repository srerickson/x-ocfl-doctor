OCFL VALIDATION REPORT: obj-050
================================

VALIDATION STATUS: INVALID
OCFL CODE: E095 - Path Conflict

VALIDATION ERROR SUMMARY
========================
The object validation failed with the following error:
  - Error Code: E095
  - Issue: Path conflict for 'file-1.txt'
  - Object Path: /workspace/objects/obj-050

DETAILED ANALYSIS
=================

The inventory.json file contains a critical inconsistency in the state mapping for version v1:

1. STATE MAPPING ISSUE:
   The 'state' section in the v1 version maps logical file paths to digest checksums.

   Current mapping shows 'file-1.txt' appearing twice with different digest checksums:

   Digest 1: 07e41ccb166d21a5327d5a2ae1bb48192b8470e1357266c9d119c294cb1e95978569472c9de64fb6d93cbd4dd0aed0bf1e7c47fd1920de17b038a08a85eb4fa1
   Maps to: file-1.txt

   Digest 2: 9fef2458ee1a9277925614272adfe60872f4c1bf02eecce7276166957d1ab30f65cf5c8065a294bf1b13e3c3589ba936a3b5db911572e30dfcb200ef71ad33d5
   Maps to: file-1.txt

   This violates OCFL spec: A single logical file path (within an object version) cannot map
   to multiple different digests, as this would be a path conflict.

2. ADDITIONAL STATE ISSUES:
   The state section also contains problematic entries:

   - One digest has 'file-3.txt' listed twice in its array: ["file-3.txt", "file-4.txt", "file-3.txt"]
     This is redundant and semantically incorrect.

   - The file 'file-4.txt' is referenced in the state but does NOT exist in the manifest.
     The manifest only contains three files: file-1.txt, file-2.txt, and file-3.txt.
     This creates an inconsistency - the state references a file that has no associated digest.

3. MANIFEST vs. STATE MISMATCH:
   Manifest contains:
     - file-1.txt
     - file-2.txt
     - file-3.txt

   Physical files in v1/content/:
     - file-1.txt
     - file-2.txt
     - file-3.txt

   State references:
     - file-1.txt (referenced TWICE with different digests)
     - file-3.txt (referenced twice, once with file-4.txt)
     - file-4.txt (referenced but does NOT exist in manifest or physical storage)

ROOT CAUSE
==========
The inventory.json file has been manually created or corrupted with inconsistent state
mappings. The state section should maintain a 1-to-1 relationship between logical file
paths and digests, ensuring each logical path maps to exactly one digest.

RECOMMENDED FIXES
=================

Option 1: Correcting the State Section (Recommended)
If the intent was to have two different versions of file-1.txt with different content,
the state should be restructured to avoid the path conflict. This would require either:
  a) Renaming one of the files (e.g., file-1.txt and file-1-v2.txt)
  b) Creating separate versions in the object

Option 2: Simplify to Correct State
The state section should be corrected to have each logical file path map to only one digest:

Corrected state structure should look like:
  "v1": {
    "created": "2021-03-31T10:21:21.740101149-05:00",
    "state": {
      "07e41ccb166d21a5327d5a2ae1bb48192b8470e1357266c9d119c294cb1e95978569472c9de64fb6d93cbd4dd0aed0bf1e7c47fd1920de17b038a08a85eb4fa1": [
        "file-1.txt"
      ],
      "9fef2458ee1a9277925614272adfe60872f4c1bf02eecce7276166957d1ab30f65cf5c8065a294bf1b13e3c3589ba936a3b5db911572e30dfcb200ef71ad33d5": [
        "file-2.txt"
      ],
      "b3b26d26c9d8cfbb884b50e798f93ac6bef275a018547b1560af3e6d38f2723785731d3ca6338682fa7ac9acb506b3c594a125ce9d3d60cd14498304cc864cf2": [
        "file-3.txt"
      ]
    }
  }

STEPS TO FIX
============
1. Open /workspace/objects/obj-050/inventory.json in a text editor
2. Locate the "versions" -> "v1" -> "state" section
3. Remove the duplicate/conflicting entry for file-1.txt (decide which digest is correct)
4. Remove the file-4.txt reference from the state (it doesn't exist in manifest)
5. Remove the duplicate "file-3.txt" entry in the state array
6. Verify that each logical file path appears exactly once across all state digests
7. Recalculate and update the inventory.json.sha512 file with the new checksum
8. Re-run: ocfl validate --object /workspace/objects/obj-050

OCFL SPECIFICATION REFERENCE
=============================
This violation relates to:
- OCFL 1.1 Specification Section on Inventory Structure
- Error Code E095: Path Conflict detection requirement
- State mapping must maintain 1-to-1 relationship between logical paths and digests
