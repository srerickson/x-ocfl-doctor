OCFL OBJECT VALIDATION REPORT
Object: obj-035
Path: /workspace/objects/obj-035
Date: 2025-11-09
Status: INVALID

================================================================================
VALIDATION ERRORS SUMMARY
================================================================================

1. ERROR (E040): Version head not most recent version
   - Issue: inventory.json specifies "head": "v2" but only v1 exists
   - Error Code: E040
   - Severity: Critical

2. WARNING (W007): Version v1 missing recommended field 'message'
   - Issue: v1 version record lacks recommended 'message' field
   - Error Code: W007
   - Severity: Warning

3. WARNING (W007): Version v1 missing recommended field 'user'
   - Issue: v1 version record lacks recommended 'user' field
   - Error Code: W007
   - Severity: Warning

================================================================================
DETAILED ANALYSIS
================================================================================

STRUCTURE ISSUES:

The root inventory.json declares "head": "v2", indicating that version 2 is the
most recent version of the object. However, only the v1 directory exists in the
object structure:

Existing Directories:
  - /workspace/objects/obj-035/v1/
  - /workspace/objects/obj-035/v1/content/

Missing Directories:
  - /workspace/objects/obj-035/v2/ (CRITICAL - This is the head version!)

Current Inventory Structure:
  - ID: ark:123/abc
  - Head: v2 (declared but missing)
  - Versions defined: v1 only
  - digestAlgorithm: sha512

ROOT CAUSE:
The object is in an incomplete state. The inventory.json was updated to reference
v2 as the head version, but the actual v2 version directory with its inventory
and content were never created or were deleted, leaving the object in an
inconsistent state.

MISSING FIELDS (WARNINGS):
According to OCFL 1.1 specification, version records should include:
  - message: A human-readable description of the version's contents/changes
  - user: Information about the user/agent that created the version

These are recommended fields, not required, but their absence is flagged as warnings.

================================================================================
RECOMMENDED STEPS FOR FIXING THE OBJECT
================================================================================

Option 1: REVERT TO V1 (Simplest Fix)
If v2 was created prematurely or erroneously, revert to v1:
  1. Edit /workspace/objects/obj-035/inventory.json
  2. Change "head": "v2" to "head": "v1"
  3. Verify the change doesn't create checksum mismatches
  4. Re-validate the object

Option 2: CREATE MISSING V2 VERSION (If v2 changes are needed)
If v2 was intended:
  1. Create directory: /workspace/objects/obj-035/v2/
  2. Create v2 version inventory.json with:
     - Updated "head" pointing to v2
     - v2 version record with state information
     - Proper manifest entries for v2 changes
  3. Create corresponding content files if any changes exist
  4. Ensure digest checksums match manifest
  5. Create v2/inventory.json.sha512 sidecar
  6. Re-validate the object

Option 3: ADD RECOMMENDED FIELDS (To address warnings)
If keeping the current structure:
  1. Edit /workspace/objects/obj-035/inventory.json
  2. Add to v1 version record:
     {
       "message": "<description of version 1 changes>",
       "user": {
         "name": "<creator name>",
         "address": "<creator address/email>"
       }
     }
  3. Update inventory.json.sha512 sidecar
  4. Re-validate

RECOMMENDED COMBINED APPROACH:
  1. First, decide if v2 is actually needed (Option 1 or 2)
  2. Fix the head version mismatch
  3. Then add the recommended user and message fields
  4. Re-validate to confirm all issues are resolved

================================================================================
VALIDATION COMMAND REFERENCE
================================================================================

To validate the object after fixes:
  ocfl validate --object /workspace/objects/obj-035

Expected output on successful validation:
  (no errors, validation should complete without errors)

================================================================================
