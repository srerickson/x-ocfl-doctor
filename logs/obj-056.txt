OCFL OBJECT VALIDATION REPORT
Object ID: obj-056
Validation Status: INVALID
Report Generated: 2025-11-09

================================================================================
VALIDATION ERRORS SUMMARY
================================================================================

Error Code: E050
Error Message: digest in v1 state not in manifest

Error Details:
The inventory.json file contains a digest in the version state that does not
exist in the manifest section. Specifically, the v1 version state references
a digest that is not declared in the object's manifest.

================================================================================
DETAILED ANALYSIS
================================================================================

1. ISSUE IDENTIFICATION
   ---------------------
   The OCFL specification requires that all digests referenced in a version's
   state must also be present in the manifest. This is a structural integrity
   requirement.

   Object Structure:
   - Location: /workspace/objects/obj-056
   - Object ID: urn:example-state-digest-not-in-manifest
   - Head Version: v1
   - Digest Algorithm: sha512
   - Content Directory: content

2. MANIFEST CONTENTS
   ------------------
   The manifest defines one entry:
   - Digest: 24f950aac7b9ea9b3cb728228a0c82b67c39e96b4b344798870d5daee93e3ae5931baae8c7cacfea4b629452c38026a81d138bc7aad1af3ef7bfd5ec646d6c28
     Maps to: v1/content/test.txt
     Actual file content: "testing"
     Verified checksum: VALID (matches actual file)

3. STATE CONTENTS (v1 version)
   --------------------------
   The v1 version state contains TWO digest entries:

   a) Valid Entry:
      - Digest: 24f950aac7b9ea9b3cb728228a0c82b67c39e96b4b344798870d5daee93e3ae5931baae8c7cacfea4b629452c38026a81d138bc7aad1af3ef7bfd5ec646d6c28
        Maps to: test.txt
        Status: VALID - This digest IS in the manifest

   b) Invalid Entry (ERROR):
      - Digest: ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
        Maps to: not_in_manifest.oops
        Status: INVALID - This digest is NOT in the manifest
        Notes: This is a placeholder/invalid digest (all 'f' characters)

4. ROOT CAUSE
   ----------
   The inventory.json contains an entry in the v1 state that references a
   digest (all f's) that does not exist in the manifest section. This violates
   OCFL spec requirement that state digests must be declared in the manifest.

   The v1 version message indicates this is intentional:
   "Example where a digest in the state is not in the manifest"

   This is a deliberate demonstration of an invalid OCFL object structure.

================================================================================
RECOMMENDED FIXES
================================================================================

To fix this object, you must remove the invalid digest from the v1 state:

Option 1: Remove the Invalid State Entry (Recommended)
   ----
   Modify /workspace/objects/obj-056/inventory.json and
   /workspace/objects/obj-056/v1/inventory.json:

   Remove or delete this section from the "state" object:
   "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff": [
     "not_in_manifest.oops"
   ]

   The state should only contain:
   "24f950aac7b9ea9b3cb728228a0c82b67c39e96b4b344798870d5daee93e3ae5931baae8c7cacfea4b629452c38026a81d138bc7aad1af3ef7bfd5ec646d6c28": [
     "test.txt"
   ]

Option 2: Add Missing Manifest Entry
   ----
   If the intent is to keep "not_in_manifest.oops" as a referenced file:
   a) Add an actual file or content with that name
   b) Calculate its correct SHA512 digest
   c) Add that digest-to-file mapping to the manifest
   d) Update the state to use the correct digest instead of the placeholder

Option 3: Create Actual File and Update Manifest
   ----
   If "not_in_manifest.oops" should exist:
   a) Create the file at v1/content/not_in_manifest.oops
   b) Calculate its SHA512 checksum
   c) Add the digest->file mapping to the manifest
   d) Recalculate inventory.json checksums in inventory.json.sha512

STEPS TO IMPLEMENT FIX (Option 1 - Recommended):

   1. Edit /workspace/objects/obj-056/inventory.json
   2. In the versions.v1.state object, remove the entire entry with digest
      "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"
   3. Save the file
   4. Copy changes to /workspace/objects/obj-056/v1/inventory.json
   5. Recalculate SHA512 of updated inventory.json:
      sha512sum /workspace/objects/obj-056/v1/inventory.json >
      /workspace/objects/obj-056/v1/inventory.json.sha512
   6. Update root inventory.json.sha512:
      sha512sum /workspace/objects/obj-056/inventory.json >
      /workspace/objects/obj-056/inventory.json.sha512
   7. Re-run validation: ocfl validate --object=/workspace/objects/obj-056

================================================================================
COMPLIANCE DETAILS
================================================================================

OCFL Specification: v1.1
Specification Reference: https://ocfl.io/1.1/spec/#inventory

Key Requirement Violated:
"Every digest that appears in the state of a version must also appear in
the manifest. All digests in the manifest must be unique."

All state digests must have corresponding manifest entries to maintain
referential integrity and ensure object fixity.

================================================================================
