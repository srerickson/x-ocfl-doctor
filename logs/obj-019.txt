OCFL OBJECT VALIDATION REPORT
Object ID: urn:example-3
Object Path: /workspace/objects/obj-019
Validation Status: INVALID
Report Generated: 2025-11-09

================================================================================
VALIDATION ERROR SUMMARY
================================================================================

Error Code: E099 (Invalid path in inventory)
Error Details: invalid path: '/v1/content/file-3.txt'
Severity: Critical

================================================================================
DETAILED ANALYSIS
================================================================================

1. PRIMARY ISSUE: Invalid Path in Fixity Section

   Location: inventory.json, lines 47-49 (fixity.md5 section)
   Problem: The fixity entry for file-3.txt uses an ABSOLUTE path starting
            with a forward slash:

            "/v1/content/file-3.txt"

   Violation: OCFL 1.1 specification requires that all paths in inventory
              manifest and fixity sections must be RELATIVE paths within the
              object. Absolute paths are not permitted.

   Impact: This invalid path reference violates OCFL structural requirements
           and causes validation to fail with error code E099.

2. SECONDARY ISSUES: Additional Path Irregularities

   While the primary validation error only mentions the absolute path issue,
   there are other path irregularities in the inventory that should be noted:

   a) Line 42 - Fixity entry with path traversal:
      "v1/content/../content/file-1.txt"
      Issue: Contains ".." (parent directory reference) which should be
             normalized to "v1/content/file-1.txt"

   b) Line 45 - Fixity entry with double slashes:
      "v1/content//file-2.txt"
      Issue: Contains "//" (double slash) which should be normalized to
             "v1/content/file-2.txt"

   c) Line 12 - Manifest entry with incorrect nesting:
      "v1/content/content/file-1.txt"
      Issue: Double "content" directory reference. The actual file is at
             "v1/content/file-1.txt", not nested under another content dir.

3. STRUCTURE VERIFICATION

   Actual file structure:
   /workspace/objects/obj-019/v1/content/
   ├── file-1.txt (4 bytes)
   ├── file-2.txt (4 bytes)
   └── file-3.txt (6 bytes)

   Expected manifest entries (should be):
   - "v1/content/file-1.txt"
   - "v1/content/file-2.txt"
   - "v1/content/file-3.txt"

================================================================================
ROOT CAUSES
================================================================================

1. ABSOLUTE PATH IN FIXITY
   - The fixity section contains an absolute path (/v1/content/file-3.txt)
   - This is the primary validation error

2. PATH NORMALIZATION FAILURES
   - Multiple fixity entries have paths that need normalization:
     * Path traversal references (..)
     * Doubled slashes (//)
     * Incorrect directory nesting (content/content)

3. MANIFEST VS FIXITY INCONSISTENCY
   - Manifest entries don't all match the actual file locations
   - Fixity entries use various non-normalized path formats

================================================================================
RECOMMENDED FIXES
================================================================================

Priority 1 (Critical - Must Fix):
----------

1. Fix the absolute path in fixity section:
   CHANGE:    "/v1/content/file-3.txt"
   TO:        "v1/content/file-3.txt"

   This is at inventory.json line 48 in the fixity.md5 section.

Priority 2 (Important - Should Fix):
----------

2. Normalize all fixity paths:
   CHANGE:    "v1/content/../content/file-1.txt"
   TO:        "v1/content/file-1.txt"

   CHANGE:    "v1/content//file-2.txt"
   TO:        "v1/content/file-2.txt"

3. Fix manifest entry with incorrect nesting:
   CHANGE:    "v1/content/content/file-1.txt"
   TO:        "v1/content/file-1.txt"
   (at inventory.json line 12)

Priority 3 (Best Practice):
----------

4. After fixing paths, recalculate and verify:
   - Ensure all digest values match the actual files
   - Verify SHA512 manifest digests are correct
   - Verify MD5 fixity digests are correct

================================================================================
REPAIR PROCEDURE
================================================================================

Steps to fix the object:

1. Backup the current inventory.json
   cp /workspace/objects/obj-019/inventory.json \
      /workspace/objects/obj-019/inventory.json.backup

2. Edit inventory.json to fix the paths:
   - Line 12: Change "v1/content/content/file-1.txt"
             to "v1/content/file-1.txt"
   - Line 42: Change "v1/content/../content/file-1.txt"
             to "v1/content/file-1.txt"
   - Line 45: Change "v1/content//file-2.txt"
             to "v1/content/file-2.txt"
   - Line 48: Change "/v1/content/file-3.txt"
             to "v1/content/file-3.txt"

3. Verify the digests are correct for each file:
   - Run: sha512sum /workspace/objects/obj-019/v1/content/*
   - Compare with values in manifest section
   - Run: md5sum /workspace/objects/obj-019/v1/content/*
   - Compare with values in fixity section

4. If digests don't match, recalculate and update inventory.json

5. Recalculate inventory.json checksum:
   sha512sum /workspace/objects/obj-019/inventory.json > \
   /workspace/objects/obj-019/inventory.json.sha512

6. Validate the object again:
   ocfl validate --object=/workspace/objects/obj-019

================================================================================
CONCLUSION
================================================================================

The object obj-019 is INVALID due to critical path violations in the OCFL
inventory file. The primary issue is an absolute path ("/v1/content/file-3.txt")
in the fixity section, which violates OCFL 1.1 specification requirements.

Additionally, multiple path normalization issues exist throughout the manifest
and fixity sections that should be corrected to ensure proper OCFL compliance.

All issues are fixable by editing the inventory.json file to use properly
formatted relative paths and ensuring digest values are accurate.

