OCFL OBJECT VALIDATION REPORT
Object ID: obj-003
Validation Date: 2025-11-09
Status: INVALID

================================================================================
VALIDATION ERROR SUMMARY
================================================================================

Error Code: E095 - Path Conflict
Location: Root inventory.json
Message: path conflict for: 'sub-path'

The OCFL object failed validation due to conflicting logical paths in the
inventory state for version v1.

================================================================================
DETAILED ANALYSIS
================================================================================

PROBLEM DESCRIPTION:
The object's inventory.json contains conflicting logical paths in the v1 version
state. Specifically:

In the v1 state section, the object defines two logical paths that create an
unresolvable conflict:
  1. "sub-path/a_file.txt" - points to digest hash 43a43fe...
  2. "sub-path" - points to digest hash 946af3b...

This violates OCFL 1.1 specification rule E095, which prohibits having both a
file path and a directory path with the same prefix. You cannot have both a
logical path that is a file ("sub-path") and another logical path that is within
a subdirectory of that same path ("sub-path/a_file.txt").

CURRENT INVENTORY STATE (v1):
{
  "43a43fe8...": ["sub-path/a_file.txt"],    <- File in subdirectory
  "946af3b...": ["sub-path"]                 <- Also a path named "sub-path"
}

MANIFEST vs STATE MISMATCH:
The root inventory.json manifest section correctly references:
  - v1/content/a_file.txt
  - v1/content/another_file.txt

However, the v1 state section incorrectly maps these to conflicting logical paths:
  - Maps to "sub-path/a_file.txt"
  - Maps to "sub-path" (not "sub-path/another_file.txt")

This creates an ambiguous situation where "sub-path" could refer to either a
file or a directory.

================================================================================
RECOMMENDED STEPS FOR FIXING THE OBJECT
================================================================================

Option 1: Fix the State Mapping (RECOMMENDED)
If the intention is to have files in a subdirectory:
  - Change "sub-path" to "sub-path/another_file.txt"
  - Both files will be logically placed under a "sub-path" directory

Modified v1 state should be:
{
  "43a43fe8...": ["sub-path/a_file.txt"],
  "946af3b...": ["sub-path/another_file.txt"]
}

Option 2: Remove the Subdirectory Nesting
If the files should be at the root logical path:
  - Change "sub-path/a_file.txt" to "a_file.txt"
  - Change "sub-path" to "another_file.txt"

Modified v1 state should be:
{
  "43a43fe8...": ["a_file.txt"],
  "946af3b...": ["another_file.txt"]
}

Option 3: Use Different Directory Names
If both paths are needed but should not conflict:
  - Rename "sub-path" to something distinct, e.g., "sub-path-file"
  - Keep "sub-path/a_file.txt" as is

Modified v1 state should be:
{
  "43a43fe8...": ["sub-path/a_file.txt"],
  "946af3b...": ["sub-path-file"]
}

================================================================================
STEPS TO IMPLEMENT THE FIX
================================================================================

1. Edit the inventory.json file to correct the state mapping
2. Recalculate the SHA-512 digest of the updated inventory.json
3. Update inventory.json.sha512 with the new digest value
4. Re-run validation: ocfl validate --object=objects/obj-003
5. Verify that the validation passes without errors

================================================================================
FILES INVOLVED
================================================================================

- /workspace/objects/obj-003/inventory.json (ROOT inventory)
- /workspace/objects/obj-003/v1/inventory.json (VERSION inventory)
- /workspace/objects/obj-003/inventory.json.sha512 (ROOT inventory digest)
- /workspace/objects/obj-003/v1/inventory.json.sha512 (VERSION inventory digest)
- /workspace/objects/obj-003/v1/content/a_file.txt
- /workspace/objects/obj-003/v1/content/another_file.txt

================================================================================
SPECIFICATION REFERENCE
================================================================================

OCFL 1.1 Specification - Rule E095:
Path conflicts occur when one logical path is a prefix of another logical path
in the same version state. For example, having both "file" and "file/nested"
is invalid, as is having both "dir" and "dir/file.txt".

All logical paths in a single version state must be unambiguous - no path can
be a prefix of another path in the same state.

================================================================================
