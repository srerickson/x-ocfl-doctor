OCFL Object Validation and Repair Log
=====================================
Object: obj-078
Date: 2025-11-13
Timestamp: 2025-11-13T09:15:00Z

VALIDATION PHASE
================
Initial validation command: ocfl validate --object=/workspace/objects/obj-078
Result: INVALID

Errors Found:
1. Digest Algorithm Mismatch in v1/inventory.json
   - Root inventory.json: digestAlgorithm = "sha512"
   - v1/inventory.json: digestAlgorithm = "sha256" (INCONSISTENT)
   - v2/inventory.json: digestAlgorithm = "sha512" (consistent)
   
   This violates OCFL 1.1 spec which requires all inventory files to declare
   consistent digest algorithms when they appear in a single OCFL object.
   
   Additionally, the v1 sidecar file was:
   - v1/inventory.json.sha256 (incorrect - should match declared algorithm)

REPAIR PHASE
============
1. Created backup copy at: /workspace/repaired/obj-078

2. Fixed v1/inventory.json:
   - Changed digestAlgorithm from "sha256" to "sha512"
   - Recalculated content manifest hash:
     OLD: af9a8763eac0ff815ff634c65f9d82374a0659a86290338b6dc45960e393a3c9 (SHA256)
     NEW: 43a43fe8a8a082d3b5343dfaf2fd0c8b8e370675b1f376e92e9994612c33ea255b11298269d72f797399ebb94edeefe53df243643676548f584fb8603ca53a0f (SHA512)
   - Updated version state to reference the new SHA512 hash

3. Updated v1 sidecar:
   - Removed: v1/inventory.json.sha256 (incorrect algorithm)
   - Created: v1/inventory.json.sha512 (correct algorithm)
   - Checksum verified with: sha512sum

VALIDATION OF REPAIRED OBJECT
=============================
Command: ocfl validate --object=/workspace/repaired/obj-078
Result: SUCCESS - No errors or warnings

Exit Code: 0
Status: VALID

CONTENT INTEGRITY
=================
All original file content preserved:
- v1/content/a_file.txt: "Hello! I am a file.\n"
- v2/content/a_file.txt: (same content)

No files deleted during repair.
All version history maintained.

SUMMARY
=======
Object Name: obj-078
Initial Status: INVALID
Final Status: VALID
Actions Taken:
  1. Fixed digest algorithm inconsistency in v1/inventory.json (sha256 -> sha512)
  2. Recalculated content hashes for SHA512 algorithm
  3. Updated v1 inventory sidecar file (sha256 -> sha512)
  4. Verified all content preserved

Repair Outcome: SUCCESS
