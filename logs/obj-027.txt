OCFL OBJECT VALIDATION REPORT
Object ID: obj-027
Object Path: /workspace/objects/obj-027
Validation Date: 2025-11-09
Status: INVALID

================================================================================
VALIDATION ERRORS SUMMARY
================================================================================

1. ERROR (E107): Digest in manifest not used in version state
   - Affected Digest: dfe9a0bbfdaab7173036571a1d9e34e2465b1e3a52e8b707bbf6dea9239a9a55b0fc9e511fc24882d7f493cd950a9dbef1de13e08a007909b21cd5ba54dc4888
   - File Path: v1/content/file2.txt
   - Severity: Critical

2. WARNING (W007): Version v1 missing recommended field 'message'
   - The 'message' field in version v1 is empty
   - Severity: Warning (recommended but not required)

3. WARNING (W009): Version v1 user address is not a URI
   - Current value: "somewhere"
   - Expected: A valid URI format (e.g., "https://example.com/user/someone")
   - Severity: Warning (recommended but not required)

================================================================================
DETAILED ANALYSIS
================================================================================

ROOT CAUSE:
The primary validation error is that the digest for file2.txt exists in the manifest section of the inventory.json but is NOT referenced in the version v1 state section. This is a critical structural inconsistency.

FILE STRUCTURE:
- inventory.json contains manifest entries for two files:
  1. file.txt (digest: e7c22b994c59d9cf2b48e549b1e24666636045930d3da7c1acb299d1c3b7f931f94aae41edda2c2b207a36e10f8bcb8d45223e54878f5b316e7ce3b6bc019629)
  2. file2.txt (digest: dfe9a0bbfdaab7173036571a1d9e34e2465b1e3a52e8b707bbf6dea9239a9a55b0fc9e511fc24882d7f493cd950a9dbef1de13e08a007909b21cd5ba54dc4888)

VERSION STATE INCONSISTENCY:
The version v1 state section only includes file.txt. File2.txt digest is in the manifest but not mapped to any file in the version state. This violates OCFL 1.1 specification which requires that all digests in the manifest must be used in version state entries.

ACTUAL FILE CONTENTS:
- file.txt: "hello" (2 bytes + newline)
- file2.txt: "hello again" (11 bytes + newline)

The files exist and their digests are correct, but the inventory.json structure is broken.

================================================================================
RECOMMENDED STEPS FOR FIXING THE OBJECT
================================================================================

Option 1: ADD file2.txt TO VERSION STATE (Recommended)
If file2.txt should be part of version v1, add it to the state section:

Current state section (line 18-22 in inventory.json):
    "state": {
        "e7c22b994c59d9cf2b48e549b1e24666636045930d3da7c1acb299d1c3b7f931f94aae41edda2c2b207a36e10f8bcb8d45223e54878f5b316e7ce3b6bc019629": [
            "file.txt"
        ]
    }

Should be changed to:
    "state": {
        "e7c22b994c59d9cf2b48e549b1e24666636045930d3da7c1acb299d1c3b7f931f94aae41edda2c2b207a36e10f8bcb8d45223e54878f5b316e7ce3b6bc019629": [
            "file.txt"
        ],
        "dfe9a0bbfdaab7173036571a1d9e34e2465b1e3a52e8b707bbf6dea9239a9a55b0fc9e511fc24882d7f493cd950a9dbef1de13e08a007909b21cd5ba54dc4888": [
            "file2.txt"
        ]
    }

Option 2: REMOVE file2.txt FROM MANIFEST (If file is not supposed to be included)
If file2.txt should not be part of the object version, remove its entry from the manifest section and delete the file from the content directory.

================================================================================
SECONDARY ISSUES TO ADDRESS
================================================================================

1. FIX USER ADDRESS (Recommended)
   Current: "somewhere"
   Should be: A valid URI, e.g., "https://example.com/users/someone"

2. ADD VERSION MESSAGE (Recommended)
   Current: "" (empty string)
   Should contain a meaningful commit-like message describing changes in v1

================================================================================
STEPS TO IMPLEMENT FIX
================================================================================

1. Edit /workspace/objects/obj-027/inventory.json
2. Update the version v1 state section to include file2.txt (Option 1 recommended)
3. Update the user.address field to a valid URI
4. Add a meaningful message for version v1
5. Re-validate using: ocfl validate --object /workspace/objects/obj-027
6. If validation still fails, ensure the inventory.json.sha512 file is updated
   (may need to recalculate the SHA512 checksum of the inventory.json file)

================================================================================
SPECIFICATION REFERENCE
================================================================================

OCFL 1.1 Specification requires:
- Every digest in the manifest MUST be referenced in at least one version state
- Version state MUST map logical file names to content digests
- All referenced digests in version state MUST exist in the manifest
- User address SHOULD be a URI
- Version message is recommended for documentation

================================================================================
