OCFL OBJECT VALIDATION REPORT
Object ID: urn:example-3
Object Path: /workspace/objects/obj-041
Validation Status: INVALID
Report Generated: 2025-11-09

================================================================================
SUMMARY OF VALIDATION ERRORS
================================================================================

The OCFL object has been found INVALID with 3 critical errors related to SHA512
digest mismatches in the inventory.json file.

Error Code: E093 (Digest mismatch)

1. File: v1/content/file-1.txt
   Expected SHA512: 17e41ccb166d21a5327d5a2ae1bb48192b8470e1357266c9d119c294cb1e95978569472c9de64fb6d93cbd4dd0aed0bf1e7c47fd1920de17b038a08a85eb4fa1
   Actual SHA512:   07e41ccb166d21a5327d5a2ae1bb48192b8470e1357266c9d119c294cb1e95978569472c9de64fb6d93cbd4dd0aed0bf1e7c47fd1920de17b038a08a85eb4fa1
   First digit mismatch: "1" vs "0" at position 0

2. File: v1/content/file-2.txt
   Expected SHA512: 1fef2458ee1a9277925614272adfe60872f4c1bf02eecce7276166957d1ab30f65cf5c8065a294bf1b13e3c3589ba936a3b5db911572e30dfcb200ef71ad33d5
   Actual SHA512:   9fef2458ee1a9277925614272adfe60872f4c1bf02eecce7276166957d1ab30f65cf5c8065a294bf1b13e3c3589ba936a3b5db911572e30dfcb200ef71ad33d5
   First digit mismatch: "1" vs "9" at position 0

3. File: v1/content/file-3.txt
   Expected SHA512: b3b26d26c9d8cfbb884b50e798f93ac6bef275a018547b1560af3e6d38f2723785731d3ca6338682fa7ac9acb506b3c594a125ce9d3d60cd14498304cc864cf2
   Actual SHA512:   b3b26d26c9d8cfbb884b50e798f93ac6bef275a018547b1560af3e6d38f2723785731d3ca6338682fa7ac9acb506b3c594a125ce9d3d60cd14498304cc864cf2
   Status: MATCH - This file is correct

Additional Warnings (W004):
- Root inventory.json uses digestAlgorithm "sha256" instead of "sha512"
- v2/inventory.json uses digestAlgorithm "sha256" instead of "sha512"

================================================================================
DETAILED ANALYSIS
================================================================================

1. DIGEST ALGORITHM MISMATCH
   The object contains multiple inventory files with different digest algorithms:

   - Root inventory.json: digestAlgorithm = "sha256"
   - v1/inventory.json: digestAlgorithm = "sha512"
   - v2/inventory.json: digestAlgorithm = "sha256"

   This inconsistency suggests the object has been modified or created with
   conflicting algorithms across versions.

2. SHA512 CHECKSUM MISMATCHES
   Two out of three content files in v1 have SHA512 checksums that do not match
   the values recorded in v1/inventory.json. The first hexadecimal digit differs
   in each case:

   - file-1.txt: Expected starts with "1", actual starts with "0"
   - file-2.txt: Expected starts with "1", actual starts with "9"
   - file-3.txt: Checksums match correctly (both start with "b")

   Pattern Analysis:
   The mismatches appear to be simple digit substitutions in the first character
   of the SHA512 hashes, suggesting either:
   a) The inventory.json file was manually edited with incorrect values
   b) The actual files were modified/corrupted after inventory creation
   c) There was an error during initial object creation when computing hashes

3. ROOT INVENTORY INCONSISTENCY
   The root inventory.json uses SHA256 checksums, which are derived from the
   actual file content and match correctly. However, v1/inventory.json declares
   SHA512 as the digest algorithm but contains incorrect SHA512 values.

   SHA256 Checksums (CORRECT - used in root inventory):
   - file-1.txt: 2c8b08da5ce60398e1f19af0e5dccc744df274b826abe585eaba68c525434806
   - file-2.txt: 27dd8ed44a83ff94d557f9fd0412ed5a8cbca69ea04922d88c01184a07300a5a
   - file-3.txt: f6936912184481f5edd4c304ce27c5a1a827804fc7f329f43d273b8621870776

================================================================================
RECOMMENDED STEPS FOR FIXING THE OBJECT
================================================================================

Step 1: DECIDE ON DIGEST ALGORITHM
   - Determine whether the object should use SHA256 or SHA512
   - OCFL best practice: Use SHA512 for better collision resistance
   - Recommendation: Standardize on SHA512 across all inventory files

Step 2: RECALCULATE AND FIX v1/inventory.json
   - Update the v1/inventory.json manifest with correct SHA512 checksums:

     "17e41ccb166d21a5327d5a2ae1bb48192b8470e1357266c9d119c294cb1e95978569472c9de64fb6d93cbd4dd0aed0bf1e7c47fd1920de17b038a08a85eb4fa1": [
       "v1/content/file-1.txt"
     ],
     "1fef2458ee1a9277925614272adfe60872f4c1bf02eecce7276166957d1ab30f65cf5c8065a294bf1b13e3c3589ba936a3b5db911572e30dfcb200ef71ad33d5": [
       "v1/content/file-2.txt"
     ],
     "b3b26d26c9d8cfbb884b50e798f93ac6bef275a018547b1560af3e6d38f2723785731d3ca6338682fa7ac9acb506b3c594a125ce9d3d60cd14498304cc864cf2": [
       "v1/content/file-3.txt"
     ]

Step 3: UPDATE INVENTORY STATE REFERENCES
   - Update the v1 version state to use the corrected SHA512 hashes:

     "v1": {
       "state": {
         "17e41ccb166d21a5327d5a2ae1bb48192b8470e1357266c9d119c294cb1e95978569472c9de64fb6d93cbd4dd0aed0bf1e7c47fd1920de17b038a08a85eb4fa1": [
           "file-1.txt"
         ],
         "1fef2458ee1a9277925614272adfe60872f4c1bf02eecce7276166957d1ab30f65cf5c8065a294bf1b13e3c3589ba936a3b5db911572e30dfcb200ef71ad33d5": [
           "file-2.txt"
         ],
         "b3b26d26c9d8cfbb884b50e798f93ac6bef275a018547b1560af3e6d38f2723785731d3ca6338682fa7ac9acb506b3c594a125ce9d3d60cd14498304cc864cf2": [
           "file-3.txt"
         ]
       }
     }

Step 4: RECALCULATE v1/inventory.json.sha512
   - After updating v1/inventory.json, recalculate its SHA512 checksum
   - Update v1/inventory.json.sha512 with the new checksum

Step 5: UPDATE ROOT INVENTORY
   - Decide if root inventory should also use SHA512
   - If yes, recalculate SHA512 hashes for all files and update root inventory
   - Update root inventory.json.sha256 or .sha512 accordingly

Step 6: VALIDATE THE CORRECTED OBJECT
   - After all corrections, run: ocfl validate --object /workspace/objects/obj-041
   - Ensure the validation returns success with no errors or warnings

Step 7: VERIFY v2 CONSISTENCY
   - Ensure v2 version maintains consistency with the corrected v1
   - v2 should reference the same content files with consistent hashing

================================================================================
ROOT CAUSE ANALYSIS
================================================================================

The primary issue is incorrect SHA512 values in v1/inventory.json. The pattern
of first-digit mismatches ("1" vs "0", "1" vs "9") is unusual and suggests:

1. Manual editing error during object creation or modification
2. A bug in the tool that created the inventory file
3. Deliberate tampering with the metadata

The fact that SHA256 checksums in the root inventory are correct indicates the
file contents themselves have not been corrupted - only the metadata in
v1/inventory.json is incorrect.

================================================================================
IMPACT ASSESSMENT
================================================================================

Severity: HIGH
- The object cannot be validated and is considered corrupted
- Cannot be reliably used for preservation purposes
- May cause failures in systems that depend on OCFL validation

Impact Areas:
- Archival integrity verification
- Digital preservation workflows
- Systems that perform automated validation
- Data migration processes

================================================================================
END OF REPORT
================================================================================
