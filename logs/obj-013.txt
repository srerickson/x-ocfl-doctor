OCFL OBJECT VALIDATION REPORT
=============================
Object ID: urn:example-2
Object Path: /workspace/objects/obj-013
Validation Status: INVALID
Date: 2025-11-09

================================================================================
SUMMARY OF VALIDATION ERRORS
================================================================================

Error Code: E060 - Digest Mismatch on inventory.json.sha512
Location: Root inventory.json.sha512 file

The root-level inventory.json file has a SHA512 checksum mismatch. The stored
checksum in inventory.json.sha512 does not match the actual computed checksum
of the inventory.json file.

  Expected (stored): 032c545b5cb61ce4fafc0cef91fd9895859dcb8f0eb9485f3d5e1a25ccc5caa061345820ceeb99f81be1f0d54df9abcedad654a82c5d7d7922d02bb165ac315a
  Actual (computed): cf60208ec99d58e971bc21fdf05356706d5b9cc2af13ed3edae5c0e54fc23a6d93b91c9ec1ccf21f9094ca170ac9c214a005382ed69e71e8aaf87b4619c93ffb

================================================================================
ANALYSIS OF THE PROBLEM
================================================================================

Object Structure:
The OCFL object at /workspace/objects/obj-013 has the following structure:
  - Declaration file: 0=ocfl_object_1.1 (correct)
  - Root inventory: inventory.json
  - Root inventory digest: inventory.json.sha512
  - Version directory: v1/
    - Version inventory: v1/inventory.json
    - Version inventory digest: v1/inventory.json.sha512
    - Content: v1/content/test.txt

Inventory Contents:
Both the root-level and v1-level inventory.json files contain identical content:
  - Object ID: urn:example-2
  - Type: https://ocfl.io/1.1/spec/#inventory
  - Digest Algorithm: sha512
  - Head Version: v1
  - Content Directory: content
  - Single manifest entry mapping test.txt content
  - Version v1 metadata with message "Changed!" at root level

Key Findings:
1. The root-level inventory.json has been MODIFIED after the checksum was recorded
   - Root inventory message: "Changed!"
   - Root inventory.json.sha512: Points to v1 inventory hash (032c545...)

2. The v1-level inventory.json has NOT been modified
   - v1 inventory message: "Simple example"
   - v1 inventory.json.sha512: Contains the correct hash for v1 inventory (032c545...)

3. The root inventory.json.sha512 file contains what appears to be the checksum
   for the v1/inventory.json, not the root inventory.json

Root inventory.json actual checksum: cf60208ec99d58e971bc21fdf05356706d5b9cc2af13ed3edae5c0e54fc23a6d93b91c9ec1ccf21f9094ca170ac9c214a005382ed69e71e8aaf87b4619c93ffb
v1/inventory.json actual checksum: 032c545b5cb61ce4fafc0cef91fd9895859dcb8f0eb9485f3d5e1a25ccc5caa061345820ceeb99f81be1f0d54df9abcedad654a82c5d7d7922d02bb165ac315a

Content Validation:
The test.txt file has correct SHA512: 24f950aac7b9ea9b3cb728228a0c82b67c39e96b4b344798870d5daee93e3ae5931baae8c7cacfea4b629452c38026a81d138bc7aad1af3ef7bfd5ec646d6c28
This matches the manifest entry, so the actual file content is intact.

Root Cause:
The root-level inventory.json was modified (message changed from "Simple example" to
"Changed!") but the inventory.json.sha512 was NOT recalculated to reflect this change.
This is a critical integrity violation in OCFL as the root inventory is meant to be
the authoritative inventory that ties all versions together.

================================================================================
RECOMMENDED STEPS FOR FIXING THE OBJECT
================================================================================

Option 1: Restore the original root inventory.json (Recommended if root inventory change was unintended)
Step 1: Revert the root inventory.json to match the v1 inventory
        - Copy v1/inventory.json to inventory.json
        - Command: cp /workspace/objects/obj-013/v1/inventory.json /workspace/objects/obj-013/inventory.json

Step 2: Recalculate the root inventory.json checksum
        - Command: sha512sum /workspace/objects/obj-013/inventory.json > /workspace/objects/obj-013/inventory.json.sha512

Step 3: Validate the corrected object
        - Command: ocfl validate --object=/workspace/objects/obj-013

Option 2: Update the checksum to match the modified inventory.json (If the change was intentional)
Step 1: Recalculate the root inventory.json checksum using the current file
        - Command: sha512sum /workspace/objects/obj-013/inventory.json > /workspace/objects/obj-013/inventory.json.sha512

Step 2: Validate the corrected object
        - Command: ocfl validate --object=/workspace/objects/obj-013

WARNING: Option 2 assumes the modification to the root inventory was intentional and
         authorized. In most preservation scenarios, the root inventory should be
         treated as immutable once created, and modifications should be made through
         version control (creating new versions).

Recommendation: Determine whether the message change from "Simple example" to "Changed!"
was intentional. If not, use Option 1 to restore integrity. If it was intentional,
use Option 2 and ensure this change is documented in your object history.

================================================================================
CONCLUSION
================================================================================

The OCFL object obj-013 is INVALID due to a digest mismatch on the root-level
inventory.json file. The file has been modified but the checksum was not updated.
This is a critical integrity issue that must be resolved before the object can be
considered valid for preservation or archival purposes.

The root-level inventory.json must either be restored to its original state (matching
v1 inventory) with its checksum recalculated, or the checksum must be recalculated
to match the current state of the file. The recommended approach depends on whether
the inventory modification was intentional or an error.

All other aspects of the object appear to be intact:
- Object declaration is correct
- Version-level inventory is valid
- Content files have correct checksums
- Manifest entries are correct
